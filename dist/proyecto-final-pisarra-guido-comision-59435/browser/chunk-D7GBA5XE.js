import{a as Ae}from"./chunk-XHYPTXDI.js";import{a as Te,b as we}from"./chunk-IXRLILUS.js";import{a as de,b as ce,d as ue,e as pe,g as ge,h as he,i as De,j as ve,k as xe,l as Se,m as Me,n as Ee,o as be,p as ye,q as Ie}from"./chunk-PGJU2VVE.js";import"./chunk-JNFBHA52.js";import{t as Z}from"./chunk-UM3USEKK.js";import{h as B,i as N,j as fe,k as Ce,l as k,m as j,n as L,o as _e}from"./chunk-BUIY3QUJ.js";import{Aa as le,Ba as me,Ca as se,i as X,k as Y,m as z,ma as R,na as ee,oa as te,qa as ie,sa as oe,ta as M,va as ne,wa as re,za as ae}from"./chunk-W43C5WKI.js";import{Cb as m,Fa as T,Ga as w,Hb as C,Mb as S,Pb as r,Qb as o,Rb as p,Sb as _,Tb as g,Vb as A,Yb as f,_b as h,a as O,b as U,c as K,cd as Q,fd as F,gd as W,ic as n,jc as E,kb as l,kc as c,la as y,lb as d,rc as D,tc as v,va as x,wa as I}from"./chunk-YTEZ3TT7.js";function ke(e,t){e&1&&n(0," Este campo es requerido ")}function je(e,t){e&1&&n(0," Este campo es requerido ")}function Le(e,t){e&1&&n(0," Este campo es requerido ")}function qe(e,t){e&1&&n(0," Este campo es requerido ")}function Ve(e,t){e&1&&n(0," Este campo es requerido ")}var q=class e{constructor(t,i,a){this.matDialogRef=t;this.formBuilder=i;this.data=a;this.courseForm=this.formBuilder.group({profesor:[null,[M.required]],commitee:[null,[M.required]],course:[null,[M.required]],startDate:[null,[M.required]],endDate:[null,[M.required]]}),this.patchFormValue()}courseForm;get isEditing(){return!!this.data?.editingCourse}patchFormValue(){if(this.data?.editingCourse){let t=this.data.editingCourse,{startDate:i,endDate:a}=t,s=K(t,["startDate","endDate"]);this.courseForm.patchValue(U(O({},s),{startDate:this.formatDate(i),endDate:this.formatDate(a)}))}}onSave(){this.courseForm.invalid?this.courseForm.markAllAsTouched():this.matDialogRef.close(U(O({},this.courseForm.value),{id:this.isEditing?this.data.editingCourse.id:Te(4),createdAt:this.isEditing?this.data.editingCourse.createdAt:new Date}))}formatDate(t){return t?new Date(t).toISOString().split("T")[0]:""}static \u0275fac=function(i){return new(i||e)(d(B),d(se),d(N))};static \u0275cmp=x({type:e,selectors:[["app-course-dialog"]],decls:46,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"example-form-field","w-100"],["formControlName","course","matInput","","type","text"],["formControlName","commitee","matInput","","type","text"],[1,"col-12"],["formControlName","profesor","matInput","","type","text"],["formControlName","startDate","matInput","","type","date"],["formControlName","endDate","matInput","","type","date"],["mat-dialog-actions",""],["mat-dialog-close","","mat-button",""],["mat-button","",3,"click"]],template:function(i,a){if(i&1&&(r(0,"h1",0),n(1),o(),r(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),n(8,"Curso"),o(),p(9,"input",6),r(10,"mat-error"),m(11,ke,1,0),o()()(),r(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),n(15,"Comisi\xF3n"),o(),p(16,"input",7),r(17,"mat-error"),m(18,je,1,0),o()()()(),r(19,"div",3)(20,"div",8)(21,"mat-form-field",5)(22,"mat-label"),n(23,"Profesor"),o(),p(24,"input",9),r(25,"mat-error"),m(26,Le,1,0),o()()(),r(27,"div",4)(28,"mat-form-field",5)(29,"mat-label"),n(30,"Inicio"),o(),p(31,"input",10),r(32,"mat-error"),m(33,qe,1,0),o()()(),r(34,"div",4)(35,"mat-form-field",5)(36,"mat-label"),n(37,"Fin"),o(),p(38,"input",11),r(39,"mat-error"),m(40,Ve,1,0),o()()()()()(),r(41,"div",12)(42,"button",13),n(43,"Cancelar"),o(),r(44,"button",14),f("click",function(){return a.onSave()}),n(45,"Guardar"),o()()),i&2){let s,u,H,b,J;l(),c(" ",a.data!=null&&a.data.editingCourse?"Editar":"Crear",` curso
`),l(2),C("formGroup",a.courseForm),l(8),S((s=a.courseForm.get("course"))!=null&&s.hasError("required")?11:-1),l(7),S((u=a.courseForm.get("commitee"))!=null&&u.hasError("required")?18:-1),l(8),S((H=a.courseForm.get("profesor"))!=null&&H.hasError("required")?26:-1),l(7),S((b=a.courseForm.get("startDate"))!=null&&b.hasError("required")?33:-1),l(7),S((J=a.courseForm.get("endDate"))!=null&&J.hasError("required")?40:-1)}},dependencies:[ae,oe,ne,re,le,me,R,ue,de,ce,pe,Ce,k,L,j]})};var P=class e{constructor(t,i){this.dialogRef=t;this.data=i}onClose(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||e)(d(B),d(N))};static \u0275cmp=x({type:e,selectors:[["app-course-details-modal"]],decls:28,vars:11,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(i,a){i&1&&(r(0,"h2",0),n(1,"Detalles del Curso"),o(),r(2,"div",1)(3,"p")(4,"strong"),n(5,"Curso:"),o(),n(6),o(),r(7,"p")(8,"strong"),n(9,"Profesor:"),o(),n(10),o(),r(11,"p")(12,"strong"),n(13,"Comisi\xF3n:"),o(),n(14),o(),r(15,"p")(16,"strong"),n(17,"Inicio:"),o(),n(18),D(19,"date"),o(),r(20,"p")(21,"strong"),n(22,"Fin:"),o(),n(23),D(24,"date"),o()(),r(25,"div",2)(26,"button",3),f("click",function(){return a.onClose()}),n(27,"Cerrar"),o()()),i&2&&(l(6),c(" ",a.data.course,""),l(4),c(" ",a.data.profesor,""),l(4),c(" ",a.data.commitee,""),l(4),c(" ",v(19,5,a.data.startDate,"dd/MM/yyyy"),""),l(5),c(" ",v(24,8,a.data.endDate,"dd/MM/yyyy"),""))},dependencies:[R,k,L,j,F]})};function Ge(e,t){e&1&&(r(0,"th",15),n(1,"Curso"),o())}function $e(e,t){if(e&1&&(r(0,"td",16),n(1),o()),e&2){let i=t.$implicit;l(),c("",i.course," ")}}function He(e,t){e&1&&(r(0,"th",15),n(1,"Profesor"),o())}function Oe(e,t){if(e&1&&(r(0,"td",16),n(1),o()),e&2){let i=t.$implicit;l(),c("",i.profesor," ")}}function Ue(e,t){e&1&&(r(0,"th",15),n(1,"Comisi\xF3n"),o())}function ze(e,t){if(e&1&&(r(0,"td",17),n(1),o()),e&2){let i=t.$implicit;l(),E(i.commitee)}}function Je(e,t){e&1&&(r(0,"th",15),n(1,"Creado"),o())}function Ke(e,t){if(e&1&&(r(0,"td",17),n(1),D(2,"date"),o()),e&2){let i=t.$implicit;l(),E(v(2,1,i.createdAt,"dd/MM/yyyy"))}}function Qe(e,t){e&1&&(r(0,"th",15),n(1,"Inicio"),o())}function We(e,t){if(e&1&&(r(0,"td",17),n(1),D(2,"date"),o()),e&2){let i=t.$implicit;l(),E(v(2,1,i.startDate,"dd/MM/yyyy"))}}function Xe(e,t){e&1&&(r(0,"th",15),n(1,"Fin"),o())}function Ye(e,t){if(e&1&&(r(0,"td",17),n(1),D(2,"date"),o()),e&2){let i=t.$implicit;l(),E(v(2,1,i.endDate,"dd/MM/yyyy"))}}function Ze(e,t){e&1&&(r(0,"th",15),n(1,"Acciones"),o())}function et(e,t){if(e&1){let i=A();r(0,"button",18),f("click",function(){T(i);let s=h().$implicit,u=h();return w(u.openModal(s))}),r(1,"mat-icon"),n(2,"edit"),o()()}}function tt(e,t){if(e&1){let i=A();r(0,"button",18),f("click",function(){T(i);let s=h().$implicit,u=h();return w(u.onDelete(s.id))}),r(1,"mat-icon"),n(2,"delete"),o()()}}function it(e,t){if(e&1){let i=A();r(0,"td",17)(1,"button",18),f("click",function(){let s=T(i).$implicit,u=h();return w(u.viewDetails(s))}),r(2,"mat-icon"),n(3,"visibility"),o()(),m(4,et,3,0,"button",19)(5,tt,3,0,"button",19),o()}if(e&2){let i=h();l(4),C("ngIf",i.isAdmin),l(),C("ngIf",i.isAdmin)}}function ot(e,t){e&1&&p(0,"tr",20)}function nt(e,t){e&1&&p(0,"tr",21)}var G=class e{constructor(t,i,a,s,u,H){this._coursesService=t;this._alertService=i;this._authService=a;this.router=s;this.activatedRoute=u;this.matDialog=H;this._authService.getUserRole().subscribe(b=>{this.isAdmin=b==="admin"})}displayedColumns=["profesor","commitee","course","createdAt","startDate","endDate","actions"];dataSource=[];isLoading=!1;isAdmin=!1;ngOnInit(){this.loadCourses()}loadCourses(){this.isLoading=!0,this._coursesService.getCourses().subscribe({next:t=>{this.dataSource=t},error:()=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}addCourse(t){this.isLoading=!0,console.log(t),this._coursesService.addCourse(t).subscribe({next:i=>{this.dataSource=[...this.dataSource,i]},error:()=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onDelete(t){this._alertService.showAlert({title:"\xA1Advertencia!",text:"\xBFEst\xE1s seguro de eliminar este curso?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar",customClass:{confirmButton:"swal2-confirm-btn",cancelButton:"swal2-cancel-btn"}}).then(i=>{i.isConfirmed&&(this.isLoading=!0,this._coursesService.deleteCourseById(t).subscribe({next:a=>{this.dataSource=a},error:a=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}}))})}openModal(t){this.matDialog.open(q,{data:{editingCourse:t}}).afterClosed().subscribe({next:i=>{i&&(t?this.handleUpdate(t.id.toString(),i):(this.dataSource=[...this.dataSource,i],this.addCourse(i)))}})}handleUpdate(t,i){this.isLoading=!0,this._coursesService.updateCourseById(t,i).subscribe({next:a=>{this.dataSource=a},error:a=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}viewDetails(t){let i=this.matDialog.open(P,{width:"500px",data:t})}static \u0275fac=function(i){return new(i||e)(d(Ae),d(we),d(Z),d(Y),d(X),d(fe))};static \u0275cmp=x({type:e,selectors:[["app-courses"]],decls:31,vars:3,consts:[[1,"container"],["mat-fab","","extended","",1,"btn-crear-curso",3,"click"],["mat-table","",1,"mat-elevation-z10",3,"dataSource"],["matColumnDef","course"],["mat-header-cell","",4,"matHeaderCellDef"],["color","red","app-hightlight","","mat-cell","",4,"matCellDef"],["matColumnDef","profesor"],["matColumnDef","commitee"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["color","red","app-hightlight","","mat-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(i,a){i&1&&(r(0,"div",0)(1,"h2"),n(2,"Cursos"),o(),r(3,"button",1),f("click",function(){return a.openModal()}),r(4,"mat-icon"),n(5,"add"),o(),n(6," Agregar curso "),o(),r(7,"table",2),_(8,3),m(9,Ge,2,0,"th",4)(10,$e,2,1,"td",5),g(),_(11,6),m(12,He,2,0,"th",4)(13,Oe,2,1,"td",5),g(),_(14,7),m(15,Ue,2,0,"th",4)(16,ze,2,1,"td",8),g(),_(17,9),m(18,Je,2,0,"th",4)(19,Ke,3,4,"td",8),g(),_(20,10),m(21,Qe,2,0,"th",4)(22,We,3,4,"td",8),g(),_(23,11),m(24,Xe,2,0,"th",4)(25,Ye,3,4,"td",8),g(),_(26,12),m(27,Ze,2,0,"th",4)(28,it,6,2,"td",8),g(),m(29,ot,1,0,"tr",13)(30,nt,1,0,"tr",14),o()()),i&2&&(l(7),C("dataSource",a.dataSource),l(22),C("matHeaderRowDef",a.displayedColumns),l(),C("matRowDefColumns",a.displayedColumns))},dependencies:[Q,te,ee,ie,ge,De,Me,ve,he,Ee,xe,Se,be,ye,F],styles:[".btn-crear-curso[_ngcontent-%COMP%]{margin-bottom:20px;background-color:orange;color:#121316}th[_ngcontent-%COMP%]{color:orange}"]})};var rt=[{path:"",component:G}],$=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=I({type:e});static \u0275inj=y({imports:[z.forChild(rt),z]})};var Ne=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=I({type:e});static \u0275inj=y({imports:[W,Ie,$,_e]})};export{Ne as CoursesModule};
